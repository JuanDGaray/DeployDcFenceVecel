<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style type="text/css">
    .body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 16px;
      line-height: 1.5;
      color: #333333;
      background-color: #f5f5f5;
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
    }
    
    table {
      border-spacing: 0;
      border-collapse: collapse;
      mso-table-lspace: 0pt;
      mso-table-rspace: 0pt;
    }
    
    td {
      padding: 0;
      vertical-align: top;
    }
    
    img {
      border: 0;
      height: auto;
      line-height: 100%;
      outline: none;
      text-decoration: none;
      -ms-interpolation-mode: bicubic;
    }
    
    /* Main container */
    .container-body {
      max-width: 600px;
      margin: 0 auto;
      background-color: #ffffff;
    }
    
    /* Header */
    .header {
      padding: 30px 20px;
      background-color: #4a6cf7;
      color: #ffffff;
      text-align: center;
    }
    
    .header h1 {
      margin: 0;
      font-size: 28px;
      font-weight: 600;
    }
    
    /* Greeting section */
    .greeting {
      padding: 30px 20px 10px;
      text-align: left;
    }
    
    /* Metrics section */
    .metrics {
      padding: 10px 20px 30px;
    }
    
    .metric-box {
      padding: 20px;
      border-radius: 8px;
      background-color: #f9f9f9;
      text-align: center;
    }
    
    .metric-value {
      font-size: 36px;
      font-weight: bold;
      color: #4a6cf7;
      margin: 10px 0;
    }
    
    .metric-label {
      font-size: 16px;
      color: #666666;
      margin: 0;
      white-space: nowrap; 
      text-overflow: ellipsis;
    }
    
    /* Charts */
    .charts {
      padding: 10px 20px 30px;
    }
    
    .chart-container {
      margin-bottom: 30px;
    }
    
    .chart-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 15px;
      color: #333333;
    }
    
    /* Donut chart styles */
    .donut-chart {
      width: 150px;
      height: 150px;
      margin: 0 auto 20px;
      border-radius: 50%;
      position: relative;
    }
    
    .donut-segment {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      border-radius: 50%;
    }
    
    .donut-hole {
      width: 60%;
      height: 60%;
      background-color: #ffffff;
      border-radius: 50%;
      position: absolute;
      top: 20%;
      left: 20%;
      z-index: 10;
    }
    
    .donut-label {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 11;
      font-weight: bold;
      font-size: 16px;
      color: #333333;
    }
    
    .chart-legend {
      margin-top: 10px;
      text-align: left;
    }
    
    .legend-item {
      margin-bottom: 8px;
      font-size: 14px;
      color: #666666;
    }
    
    .legend-color {
      display: inline-block;
      width: 12px;
      height: 12px;
      margin-right: 8px;
      border-radius: 2px;
    }
    
    /* Recommendations */
    .recommendations {
      padding: 20px;
      background-color: #f0f4ff;
      border-left: 4px solid #4a6cf7;
      margin: 0 20px 30px;
    }
    
    .recommendations h2 {
      margin-top: 0;
      font-size: 20px;
      color: #333333;
    }
    
    .recommendation-item {
      margin-bottom: 10px;
      padding-left: 20px;
      position: relative;
    }
    
    .recommendation-item:before {
      content: "•";
      position: absolute;
      left: 0;
      color: #4a6cf7;
    }
    
    /* Footer */
    .footer {
      padding: 20px;
      background-color: #f5f5f5;
      text-align: center;
      color: #999999;
      font-size: 14px;
    }
    
    /* Responsive styles */
    @media screen and (max-width: 480px) {
      .metric-box {
        padding: 15px 10px;
      }
      
      .metric-value {
        font-size: 28px;
      }
      
      .header h1 {
        font-size: 24px;
      }
      
      .donut-chart {
        width: 120px;
        height: 120px;
      }
    }
  </style>
</head>
<body class="body">
  <table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#f5f5f5">
    <tr>
      <td align="center" valign="top" style="padding: 20px 0;">

        <!-- Main container -->
        <table class="container-body" width="100%" border="0" cellpadding="0" cellspacing="0" 
        bgcolor="#ffffff">
        <img style='margin-bottom: 1rem;' src='data:image/png;base64,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'>
          <!-- Header -->
          <tr>
            <td class="header">
              <h1>{{ actual_month }} Metrics Report</h1>
              
            </td>
          </tr> 
          <!-- Greeting -->
          <tr>
            <td class="greeting">
              <h2 class>Hello {{ user.first_name }} {{ user.last_name }},</h2>
              <p>Here's a summary of dayli performance company. Keep up the good work!</p>
            </td>
          </tr>
          
          <!-- Key metrics -->
          <tr>
            <td class="metrics">
              <h2 style="margin-top: 0;">Key Metrics</h2>
              
              <table width="100%" border="0" cellpadding="0" cellspacing="0">
                <tr style="border-bottom: 1px solid #ccc;">
                    <td width="10%" height="100%" bgcolor="#fff" style="text-align: center; vertical-align: middle; border-right: 1px solid #ccc;">
                        <h3 style=" white-space: nowrap;">
                            {{ previous_month }}
                        </h3>
                    </td>
                      <td width="30%" style="">
                        <div class="metric-box">
                          <p class="metric-value">{{ projects_sales_month_previous.count }}</p>
                          <p class="metric-label">Projects Created</p>
                        </div>
                      </td>
                      <td width="30%" style="padding: 0 5px;">
                        <div class="metric-box">
                          <p class="metric-value">{{ customer_sales_push_previous.count }}</p>
                          <p class="metric-label">New Clients</p>
                        </div>
                      </td>
                      <td width="30%" style="">
                        <div class="metric-box">
                          <p class="metric-value">{{ proposals_sales_month_previous.count }}</p>
                          <p class="metric-label">Proposals Generated</p>
                        </div>
                      </td>
                    </tr>
                <tr>
                <td width="10%" height="100%" style="text-align: center; vertical-align: middle; border-right: 1px solid #ccc;">
                    <h3 style=" white-space: nowrap;">
                        {{ actual_month }}
                    </h3>
                </td>
                  <td width="30%" style="">
                    <div class="metric-box">
                      <p class="metric-value">{{ projects_sales_month.count }}</p>
                      <p class="metric-label">Projects Created</p>
                    </div>
                  </td>
                  <td width="30%" style="padding: 0 5px;">
                    <div class="metric-box">
                      <p class="metric-value">{{ customer_sales_push.count }}</p>
                      <p class="metric-label">New Clients</p>
                    </div>
                  </td>
                  <td width="30%" style="">
                    <div class="metric-box">
                      <p class="metric-value">{{ proposals_sales_month.count }}</p>
                      <p class="metric-label">Proposals Generated</p>
                    </div>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
          
          <!-- Charts -->
          <tr>
            <td class="charts">
            <h2 style="margin-top: 0;">Visual Analysis</h2>
            
            <!-- Client Types Donut Chart -->
            <div class="chart-container">
            <p class="chart-title" style="text-align: left;">Client Types</p>
            
            <!-- Donut Chart using HTML/CSS -->
            <canvas id="canvas" width="150" height="150" style="display:none;"></canvas>
            <img id="chart_figure_client" style='width: 200px;height: 200px;' src="{{ base64img.chart_figure_client }}">
                
            <!-- Legend -->
            <div class="chart-legend" style="max-width: 250px; margin: 0 auto;">
            {% for item in customer_by_type %}
                <div class="legend-item">
                <span class="legend-color" style="background-color: {{ item.color }};"></span>
                {{ item.customer_type|title }} ({{ item.count }})
                </div>
            {% endfor %}
            </div>
            </div>
            <!-- Proposal Status Donut Chart -->         
            <div class="chart-container">
                <p class="chart-title" style="text-align: right;">Proposal by Status</p>
                
                <!-- Donut Chart using HTML/CSS -->
                <img id="chart_figure_proposal" style='width: 200px;height: 200px; margin-left: 60%;' src="{{ base64img.chart_figure_proposal }}">
                
                <!-- Legend -->
                <div class="chart-legend" style="max-width: 250px; margin-left: 60%;">
                {% for item in proposals_by_status %}
                    <div class="legend-item">
                    <span class="legend-color" style="background-color: {{ item.color }};"></span>
                    {{ item.status|title }} ({{ item.count }})
                    </div>
                {% endfor %}
            </div>

            <!-- Project Status Donut Chart -->         
            <div class="chart-container">
                <p class="chart-title" style="">Project by Status</p>
                
                <!-- Donut Chart using HTML/CSS -->
                  <div id="chart_figure_project" style="width: 200px; height: 200px; background-image: url('{{ base64img.chart_figure_project }}'); background-size: contain; background-repeat: no-repeat; background-position: center;"></div>
                <!-- Legend -->
                <div class="chart-legend" style="max-width: 250px;">
                {% for item in projects_by_status %}
                    <div class="legend-item">
                    <span class="legend-color" style="background-color: {{ item.color }};"></span>
                    {{ item.status|title }} ({{ item.count }})
                    </div>
                {% endfor %}
            </div>
            </div>
 
        <!-- Issues metrics -->
        {% if issues %}
        <tr>
            <td class="metrics">
            <h2 style="margin-bottom: 1rem;">Pending Issues</h2>
            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                {% for issue in issues %}
                    <tr style="margin-top: 10px;;">
                        <td width="10%" height="100%" bgcolor="#fff" style="text-align: center; vertical-align: middle; border-right: 1px solid #ccc; padding: 10px;">
                            <h4 style="">
                                {{ issue.title }}
                            </h4>
                        </td>
                        <td width="90%" style="">
                            <div class="metric-box">
                            <p class="metric-label" style="font-size: 1.5rem; text-wrap: wrap; margin: auto;  text-align: center; justify-content: center;">{{ issue.message}}
                                <a href="{{ issue.link }}" style="color: #4a6cf7; text-decoration: underline" target="_blank">link</a>
                            </p>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </table>
            </td>
        </tr>
        {% endif %}

        <!-- AI Recommendations -->
        <tr>
            <td>
            <div class="recommendations">
                <h2>Fenci Analysis</h2>
                {% for observation in observations %}
                    <div class="recommendation-item">
                    <p>{{ observation }}</p>
                    </div>
                {% endfor %}
            </div>
            </td>
        </tr>
        <!-- Footer -->
        <tr>
            <td class="footer">
            <p>This is an automated email. Please do not reply to this message.</p>
            <p>© 2025 Sales Metrics System. All rights reserved.<br> Aproved by Juan Garay (Data Analyst & Python Developer)</p>
            </td>
        </tr>
        </table>
    </td>
    </tr>
</table>
</body>
</html>
